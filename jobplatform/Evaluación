import datetime

# ---------------------------
# Datos iniciales
# ---------------------------

# Lista de libros en la biblioteca (cada libro tiene: t√≠tulo, cantidad disponible)
libros = {
    "Python B√°sico": 3,
    "Algoritmos en C": 2,
    "Bases de Datos": 1
}

# Registro de pr√©stamos (para este ejemplo lo guardaremos en una lista)
prestamos = []

# Usuario que ingresa al sistema (bibliotecario)
def login():
    usuario = input("Ingrese su usuario de bibliotecario: ")
    contrase√±a = input("Ingrese su contrase√±a: ")
    # Nota: Aqu√≠ no validamos en base de datos, solo simulamos.
    print(f"\n¬°Bienvenido, {usuario}! ‚úÖ\n")
    return usuario


# ---------------------------
# Funciones principales
# ---------------------------

def mostrar_libros():
    print("\n--- Libros disponibles ---")
    for titulo, cantidad in libros.items():
        print(f"{titulo} - disponibles: {cantidad}")


def prestar_libro(bibliotecario):
    mostrar_libros()
    libro = input("\nIngrese el t√≠tulo del libro que quiere prestar: ")

    if libro not in libros:
        print("‚ùå Ese libro no existe en el cat√°logo.")
        return

    if libros[libro] == 0:
        print("‚ùå Ese libro ya est√° prestado (sin copias disponibles).")
        return

    usuario_id = input("Ingrese la c√©dula o carnet del usuario: ")
    tipo = input("¬øEs Estudiante (E) o Profesor (P)? ").upper()

    # Calcular fechas
    hoy = datetime.date.today()
    if tipo == "E":
        devolucion = hoy + datetime.timedelta(days=7)
    elif tipo == "P":
        devolucion = hoy + datetime.timedelta(days=14)
    else:
        print("‚ùå Tipo de usuario inv√°lido.")
        return

    confirmar = input("¬øConfirmar pr√©stamo? (s/n): ").lower()
    if confirmar != "s":
        print("Operaci√≥n cancelada.")
        return

    # Actualizar disponibilidad
    libros[libro] -= 1

    # Guardar pr√©stamo
    registro = {
        "usuario": usuario_id,
        "tipo": tipo,
        "libro": libro,
        "fecha_inicio": hoy,
        "fecha_fin": devolucion,
        "bibliotecario": bibliotecario
    }
    prestamos.append(registro)

    # Simular "guardar en archivo" ‚Üí aqu√≠ solo mostramos en pantalla
    print("\n--- RECIBO ---")
    print(f"Libro: {libro}")
    print(f"Usuario: {usuario_id} ({tipo})")
    print(f"Fecha inicio: {hoy}")
    print(f"Fecha fin: {devolucion}")
    print("-----------------------\n")


def devolver_libro():
    usuario_id = input("Ingrese la c√©dula/carnet del usuario: ")
    libro = input("Ingrese el t√≠tulo del libro que devuelve: ")

    for registro in prestamos:
        if registro["usuario"] == usuario_id and registro["libro"] == libro:
            prestamos.remove(registro)
            libros[libro] += 1
            print("\n‚úÖ Libro devuelto correctamente.\n")
            return

    print("‚ùå No se encontr√≥ ese pr√©stamo.")


# ---------------------------
# Men√∫ principal
# ---------------------------

def menu():
    bibliotecario = login()

    while True:
        print("=== Men√∫ Biblioteca Express ===")
        print("1. Ver libros disponibles")
        print("2. Prestar libro")
        print("3. Devolver libro")
        print("4. Salir")

        opcion = input("Seleccione una opci√≥n: ")

        if opcion == "1":
            mostrar_libros()
        elif opcion == "2":
            prestar_libro(bibliotecario)
        elif opcion == "3":
            devolver_libro()
        elif opcion == "4":
            print("üëã Hasta luego.")
            break
        else:
            print("‚ùå Opci√≥n inv√°lida, intente de nuevo.")


# ---------------------------
# Punto de entrada del programa
# ---------------------------

if __name__ == "__main__":
    menu()
